---
title: Validator
description: Validate request body/query/params with Zod
---

# Validator

Use validator to check request input with Zod before your route handler runs.

It supports:
- `body`
- `query`
- `params`

---

## Installation

<Tabs items={['npm', 'pnpm', 'bun']}>
  <Tab value="npm">
  ```bash
  npx zuro-cli add validator
  ```
  </Tab>
  <Tab value="pnpm">
  ```bash
  pnpm dlx zuro-cli add validator
  ```
  </Tab>
  <Tab value="bun">
  ```bash
  bun x zuro-cli add validator
  ```
  </Tab>
</Tabs>

---

## What Gets Added

<Files>
  <Folder name="src" defaultOpen>
    <Folder name="middleware" defaultOpen>
      <File name="validate.ts" />
    </Folder>
  </Folder>
</Files>

Runtime dependency installed:
- `zod`

---

## Validator API

```ts
validate(schema, options?)
```

`schema` should validate this shape:

```ts
{
  body?: unknown;
  query?: unknown;
  params?: unknown;
}
```

### Options

| Option | Type | Default | Purpose |
|--------|------|---------|---------|
| `targets` | `("body" \| "query" \| "params")[]` | `["body","query","params"]` | Select which parts to validate |
| `unknownKeys` | `"strip" \| "passthrough"` | `"strip"` | Remove unknown keys or keep them |
| `statusCode` | `number` | `422` | Validation failure HTTP status |
| `formatError` | `(error: ZodError) => ValidationErrorResponse` | built-in formatter | Customize error response JSON |

---

## Important Behavior

- Parsed/coerced/defaulted values are written back to `req.body`, `req.query`, and `req.params`.
- Non-Zod errors are passed to `next(error)`.
- Validation errors return a structured JSON response.

Default error response:

```json
{
  "status": "error",
  "code": "VALIDATION_ERROR",
  "message": "Validation failed",
  "errors": [
    { "path": "body.email", "message": "Invalid email" }
  ]
}
```

---

## Basic Usage

```ts
import { Router } from "express";
import { z } from "zod";
import { validate, type ValidatedRequest } from "./middleware/validate";

const router = Router();

const createUserSchema = z.object({
  body: z.object({
    name: z.string().min(2),
    email: z.string().email(),
  }),
});

router.post(
  "/users",
  validate(createUserSchema),
  (req: ValidatedRequest<typeof createUserSchema>, res) => {
    const { name, email } = req.body;
    res.json({ name, email });
  }
);
```

---

## Query + Params Example

```ts
const listPostsSchema = z.object({
  query: z.object({
    page: z.coerce.number().min(1).default(1),
    limit: z.coerce.number().min(1).max(100).default(20),
  }),
  params: z.object({
    userId: z.string().uuid(),
  }),
});

router.get(
  "/users/:userId/posts",
  validate(listPostsSchema),
  (req: ValidatedRequest<typeof listPostsSchema>, res) => {
    const { page, limit } = req.query;
    const { userId } = req.params;
    res.json({ page, limit, userId });
  }
);
```

---

## Validate Specific Targets Only

```ts
const searchSchema = z.object({
  query: z.object({
    q: z.string().min(1),
  }),
});

router.get(
  "/search",
  validate(searchSchema, { targets: ["query"] }),
  (req: ValidatedRequest<typeof searchSchema>, res) => {
    res.json({ q: req.query.q });
  }
);
```

---

## Custom Error Format

```ts
const schema = z.object({
  body: z.object({
    title: z.string().min(1),
  }),
});

router.post(
  "/posts",
  validate(schema, {
    statusCode: 400,
    formatError: (error) => ({
      status: "error",
      code: "VALIDATION_ERROR",
      message: "Invalid input",
      errors: error.issues.map((issue) => ({
        path: issue.path.join("."),
        message: issue.message,
      })),
    }),
  }),
  (_req, res) => res.json({ ok: true })
);
```

---

## Works with Error Handler

Validator returns Zod validation responses directly by default.

If another error happens inside middleware/handler, it still goes through `next(error)` and is handled by your error middleware:

```bash
npx zuro-cli add error-handler
```

---

## Next Steps

<div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-6">
  <a href="/docs/error-handler" className="block border border-border rounded-xl p-5 bg-card hover:border-green-500/50 transition-colors no-underline">
    <h3 className="font-bold text-foreground mb-1">→ Add Error Handler</h3>
    <p className="text-sm text-muted-foreground">Centralized API error responses</p>
  </a>

  <a href="/docs/auth" className="block border border-border rounded-xl p-5 bg-card hover:border-green-500/50 transition-colors no-underline">
    <h3 className="font-bold text-foreground mb-1">→ Add Auth</h3>
    <p className="text-sm text-muted-foreground">User auth and protected routes</p>
  </a>
</div>
